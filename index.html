<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>聖誕動物交換花束派對</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="loading" class="loading-overlay">
    <div style="font-size:40px;">⏳</div>
    <p>正在同步資料...</p>
</div>

<div class="container">
    <header>
        <div class="brand-container">
            <img src="logo.png" alt="兜是花 Logo" class="brand-logo" onerror="this.src='https://placehold.co/100x100/FFF/2c5e2e?text=Logo'">
            <div class="brand-name">兜是花 @doseflower.asap</div>
        </div>
        <h1>聖誕動物交換花束派對 🎄</h1>
    </header>

    <div id="phase-intro">
        <section>
            <div class="intro-text">
                <div class="intro-title">叮叮噹～叮叮噹～<br>歡迎來到聖誕交換花束派對！</div>
                <p>
                在這裡，你會化身成一隻小動物。<br>
                <strong>你會為某一隻小動物準備一束花，</strong><br>
                也會在交換中，<br>
                <strong>收到另一隻小動物悄悄為你配好的花束與祝福。</strong><br>
                你想當什麼小動物、想送給誰、或希望收到誰的花束，都可以許願喔。<br>
                <strong>「配花是數位化的，會在這個網頁上直接完成，非常簡單！」</strong></p>
            </div>
            <div class="intro-block">
                <h3>💰 一束花 $650，你會收到：</h3>
                <ul>
                    <li>一束由另一隻小動物為你配好的花</li>
                    <li>一段來自他的祝福文字</li>
                    <li>一個可以和他延續對話的email</li>
                    <li>提袋、小卡片，以及營養粉 ×2</li>
                    <li>你親手配的花束照片 (12/26 由兜是花寄到你的 email)</li>
                </ul>
            </div>
            <div class="intro-block">
                <h3>📦 取花方式</h3>
                <ul>
                    <li><strong>取花時間：</strong>12/26 (五) 16:00-19:30</li>
                    <li><strong>公館自取：</strong>公館捷運附近，無接觸取件，直接拎花即可。</li>
                    <li><strong>指定時間配送：</strong>需收件人當場在場，無法放門口。</li>
                </ul>
            </div>
            <div class="intro-block" style="border-color: #c0392b; background: #fff5f5;">
                <h3>⚠️ 注意事項</h3>
                <ul>
                    <li>花束需<strong>先匯款</strong>，才算報名成功 (匯款方式在第二頁)。</li>
                    <li>報名截止日期：<strong>12/24 結束前</strong>。</li>
                    <li>訂花確認信會在 <strong>12/24 結束前</strong> 寄到你的 email。</li>
                </ul>
            </div>
            <div class="btn-group"><button id="btn-start" class="btn btn-primary">開始許願與配花 ➡️</button></div>
        </section>
    </div>

    <div id="phase-game" class="hidden">
        <section>
            <h2>1. 請問你是哪位動物？</h2>
            <div id="role-list" class="role-list"></div>
        </section>

        <section>
            <h2>2. 交換心願</h2>
            <div class="form-group">
                <label>你希望收到誰配的花？(請選 3 位)</label>
                <div class="wish-row"><span class="wish-label">❤️ 最想收到</span><select id="recv-1" class="recv-group" onchange="updateWishes('recv')"><option value="">請選擇...</option></select></div>
                <div class="wish-row"><span class="wish-label">👍 備選 1</span><select id="recv-2" class="recv-group" onchange="updateWishes('recv')"><option value="">請選擇...</option></select></div>
                <div class="wish-row"><span class="wish-label">👌 備選 2</span><select id="recv-3" class="recv-group" onchange="updateWishes('recv')"><option value="">請選擇...</option></select></div>
            </div>
            <div class="form-group" style="margin-top: 30px;">
                <label>你想把你的花送給誰？(請選 3 位)</label>
                <div class="wish-row"><span class="wish-label">🎁 最想送給</span><select id="give-1" class="give-group" onchange="updateWishes('give')"><option value="">請選擇...</option></select></div>
                <div class="wish-row"><span class="wish-label">👍 備選 1</span><select id="give-2" class="give-group" onchange="updateWishes('give')"><option value="">請選擇...</option></select></div>
                <div class="wish-row"><span class="wish-label">👌 備選 2</span><select id="give-3" class="give-group" onchange="updateWishes('give')"><option value="">請選擇...</option></select></div>
            </div>
        </section>

        <section>
            <h2>3. 花藝實驗室 🎨</h2>
            <p style="font-size:14px; color:#555; margin-top:-10px; background:#fff3cd; padding:10px; border-radius:8px;">
                請將花材拖入下方牛皮紙範圍內插花。<br>
                <strong>💡 限制：全花材混搭，最多挑選 6 支。</strong><br>
                <span style="font-size:12px; color:#888;">(若要刪除花材，請在畫布上的花朵「快點兩下」)</span>
            </p>
            
            <div class="canvas-container" id="flower-canvas">
                <div class="canvas-bg"></div>
                
                <div class="canvas-counter">
                    <span id="cnt-total" class="count-val">0/6</span>
                </div>
                
                <span style="position:absolute; top:30%; width:100%; text-align:center; color:#ccc; pointer-events:none; font-size:12px;">(拖曳花材到這裡)</span>
            </div>
            
            <div class="flower-assets" id="asset-list"></div>
            <div style="text-align: center; margin-top: 10px;">
                <button onclick="clearCanvas()" style="background:none; border:1px solid #ccc; padding:8px 15px; border-radius:20px; font-size:13px; cursor:pointer; color:#666;">🔄 清空重來</button>
            </div>

            <div class="pref-block">
                <div class="pref-title">缺貨替代方案</div>
                <div class="pref-desc">
                    花材皆為新鮮採購，若遇市場缺貨，我們會盡量維持設計感。<br>
                    若指定花材沒有了，請問您比較在意的是？
                </div>
                <div class="pref-options">
                    <label>
                        <input type="radio" name="subPref" value="color" checked>
                        <span>🎨 顏色要相近，花種可以調整</span>
                    </label>
                    <label>
                        <input type="radio" name="subPref" value="flower">
                        <span>🌸 花種要一樣，顏色不同沒關係</span>
                    </label>
                </div>
            </div>
        </section>

        <section>
            <h2>4. 寫下祝福</h2>
            <div class="form-group">
                <textarea id="msg-input" rows="6" placeholder="寫下暖心的話..."></textarea>
                
                <div class="blessing-note">
                    <p>祝福沒有長度限制，這段話會由另一隻小動物收到。</p>
                    <p>如果你願意，可以多寫一點，分享你這一年的小心得，或對明年的小期許，會讓這份交換更完整。</p>
                    <p>你的 email 也會一起交給這位小動物。之後會不會聯繫、會發生什麼，就留給你們自己決定：）</p>
                </div>
            </div>
        </section>

        <div class="btn-group"><button id="btn-next" class="btn btn-primary">下一步：填寫資料 ➡️</button></div>
    </div>

    <div id="phase-info" class="hidden">
        <section>
            <h2>5. 選擇取花方式</h2>
            <div class="radio-group">
                <label class="radio-option active" id="opt-self" onclick="toggleMethod('self')"><input type="radio" name="deliveryMethod" value="自取" checked> 🏢 人性空間自取</label>
                <label class="radio-option" id="opt-delivery" onclick="toggleMethod('delivery')"><input type="radio" name="deliveryMethod" value="運送"> 🚚 專車運送 (+200)</label>
            </div>
            <div id="block-self" class="method-block">
                <div class="form-group">
                    <label>預計自取時段 (12/26)：</label>
                    <select id="self-time">
                        <option value="">請選擇時段...</option>
                        <option value="12/26 16:00-16:30">16:00-16:30</option>
                        <option value="12/26 16:30-17:00">16:30-17:00</option>
                        <option value="12/26 17:00-17:30">17:00-17:30</option>
                        <option value="12/26 17:30-18:00">17:30-18:00</option>
                        <option value="12/26 18:00-18:30">18:00-18:30</option>
                        <option value="12/26 18:30-19:00">18:30-19:00</option>
                        <option value="12/26 19:00-19:30">19:00-19:30</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>地點：人性空間 (公館)</label>
                    <div class="map-container"><iframe src="https://maps.google.com/maps?q=人性空間公館&t=&z=16&ie=UTF8&iwloc=&output=embed" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe></div>
                </div>
            </div>
            <div id="block-delivery" class="method-block hidden">
                <div class="warning-text">⚠️ 司機抵達會電話聯繫，請務必在電話後 15 分鐘內取貨！</div>
                
                <div class="delivery-map-container">
                    <p style="font-size:14px; font-weight:bold; color:#555; margin-bottom:5px;">👇 配送範圍示意圖 (橘框內)</p>
                    <img src="region.jpeg" alt="配送範圍圖" onclick="window.open(this.src, '_blank')">
                    <p style="font-size:12px; color:#888;">(點擊圖片可放大)</p>
                </div>

                <div class="form-group" style="margin-top:15px;">
                    <label>配送地址：</label>
                    <input type="text" id="delivery-address" placeholder="請輸入完整地址 (含行政區)...">
                </div>

                <label class="zone-confirm">
                    <input type="checkbox" id="zone-check">
                    <span>我已確認收件地址位於上圖的橘色框線範圍內</span>
                </label>

                <div class="form-group">
                    <label>希望配送時段：</label>
                    <select id="delivery-time">
                        <option value="">請選擇...</option>
                        <option value="12/26 下午 A (13:00-15:00)">下午 A (13:00-15:00)</option>
                        <option value="12/26 下午 B (15:00-17:00)">下午 B (15:00-17:00)</option>
                        <option value="12/26 晚上 C (18:00-20:00)">晚上 C (18:00-20:00)</option>
                    </select>
                </div>
            </div>
        </section>

        <section>
            <h2>6. 聯絡資料</h2>
            <div class="form-group"><input type="email" id="email-input" placeholder="Email"></div>
            <div class="form-group"><input type="tel" id="phone-input" placeholder="手機"></div>
            <div class="form-group"><input type="text" id="name-input" placeholder="暱稱"></div>
        </section>

        <section>
            <h2>7. 匯款資訊</h2>
            <div class="price-summary">
                <div class="price-label">本次報名總金額</div>
                <div class="price-amount">NT$ <span id="total-price">650</span></div>
                <div class="price-detail" id="price-detail">(花束 $650)</div>
            </div>
            <div class="bank-info">銀行：<strong>國泰世華 (013)</strong><br>帳號：<strong>105501316365</strong><br>備註請填：<strong>FlowerFriday 5</strong></div>
            <div class="form-group"><label>匯款帳號末五碼：</label><input type="text" id="pay-input" placeholder="請輸入末五碼"></div>
        </section>

        <div class="btn-group">
            <button id="btn-back" class="btn btn-secondary">⬅️ 返回</button>
            <button id="btn-submit" class="btn btn-primary">確認報名</button>
        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>
